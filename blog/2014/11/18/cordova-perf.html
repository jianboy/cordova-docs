<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="format-detection" content="telephone=no">
    <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width" />
    <meta name="description" content="While developing mobile apps with Cordova,performance is a common concern many developers have.Though recent WebView improvements have made smooth experience...">

    <title>
        
            
                Automating Performance Audits for Cordova apps - Cordova 中文网
            
        
    </title>

    <link rel="SHORTCUT ICON" href="/favicon.ico"/>

    

    
    

    <link rel="canonical" href="https://cordova.apache.org/blog/2014/11/18/cordova-perf.html">

    <!-- CSS -->
    <link rel="stylesheet" type="text/css" href="/static/css/main.css">
    <link rel="stylesheet" type="text/css" href="/static/css/lib/syntax.css">
    <!-- Algolia Search CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css" />

    <!-- Fonts -->
    <!-- For attribution information, see www/attributions.html -->
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <script type="text/javascript">
        var disqus_developer = 1; // this would set it to developer mode
    </script>

    <!-- JS -->
    <script defer type="text/javascript" src="/static/js/lib/jquery-2.1.1.min.js"></script>
    <script defer type="text/javascript" src="/static/js/lib/bootstrap.min.js"></script>
    <script defer type="text/javascript" src="/static/js/lib/ZeroClipboard.js"></script>

</head>

<body>
    <header>
    <a class="scroll-point pt-top" name="top"></a>
    <nav class="navbar navbar-inverse navbar-fixed-top">
        <div class="container-fluid">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/"><img id="logo_top" src="/static/img/cordova-logo-newbrand.svg"/></a>
            </div>
            <div id="navbar" class="navbar-collapse collapse">
                <div class="nav_bar_center">
                    <ul class="nav navbar-nav">
                        <li >
                            <a href="/docs/zh-cn/9.x/">cordova中文文档</a>
                        </li>
                        <li >
                            <a href="/plugins">插件</a>
                        </li>
                        <li class="active">
                            <a href="/blog" id="blog_button">cordova博客<span class="badge" id="new_blog_count"></span></a>
                        </li>
                        <li class="active">
                            <a href="/community" id="blog_button">cordova中文社区<span class="badge" id="new_blog_count"></span></a>
                        </li>
                        <li >
                            <a href="/contribute">贡献</a>
                        </li>
                        <li>
                            <a href="/#getstarted">快速开始</a>
                        </li>
                        <li>
                            <form class="navbar-form navbar-right" id="header-search-form" role="search">
                                <div class="input-group">
                                    
                                        
                                    
                                    <input id="header-search-field" type="text" placeholder="Search '9.x' docs..." class="form-control hidden-xs" autocomplete="off">
                                </div>
                            </form>
                        </li>
                    </ul>
                </div>
            </div><!--/.navbar-collapse -->
        </div>
    </nav>
    <div id="_fixed_navbar_spacer" style="padding-top:50px"></div>
</header>

<div class="page container">
    <div class="blog">
    <h1 class="blogHeader">
    Blog
    <span class="rss">
        <img src="/static/img/subscribe.png"><a href="/feed.xml">RSS Feed</a>
    </span>
</h1>

<div class="post">
    <header>
        <div class="title">Automating Performance Audits for Cordova apps</div>
        <div class="author">By:
            
              <a href="https://twitter.com/nparashuram">Parashuram</a>
            
        </div>
        <div class="date">18 Nov 2014</div>
    </header>
    <section>
        <div>
            <p>While developing mobile apps with Cordova,
performance is a common concern many developers have.
Though recent WebView improvements have made smooth experiences easy to achieve,
it is always important to watch out for code in our apps that may make the app <a href="http://jankfree.org">janky</a>.</p>

<h2>Measuring Performance</h2>

<p>The latest versions of <strong>Android</strong> and <strong>iOS</strong> <em>WebView</em>s can connect to and leverage developer tools in browsers for profiling rendering performance of apps.
Developer tools provide insights into details like frames rates, repaints, layouts, etc.</p>

<p><img src="https://i.imgur.com/zR2f1.gif" alt="Chrome Developer tools - profiling"></p>

<p>Articles (like
<a href="http://aerotwist.com/blog/my-performance-audit-workflow/">my performance audit workflow</a>
and
<a href="http://calendar.perfplanet.com/2013/the-runtime-performance-checklist/">the runtime performance checklist</a>)
articulate the typical workflow for auditing performance of webpages.
Similar principles can be applied to apps too.</p>

<!--more-->

<h2>Automating Performance measurements</h2>

<p>With rapid development and release cycles of apps,
it becomes hard to do regular performance audits.
Automating the process with tools would ensure that we have a handle on the performance of the app.</p>

<p><a href="http://npmjs.org/package/browser-perf">browser-perf</a> is a <strong>NodeJS</strong> based tool picks up data from browser developer tools and converts them to key performance indicators.
It is based on <strong>Chromium</strong>&#39;s performance test suite,
<a href="http://www.chromium.org/developers/telemetry">telemetry</a>,
and supports <strong>iOS</strong> and <strong>Android</strong> based <strong>Cordova</strong> apps.
All metrics are recorded while mimicking typical user interactions.</p>

<h2>Testing iOS Apps</h2>

<p>To start testing your <strong>Cordova</strong> app for <strong>iOS</strong>,
you would need to <code>npm install appnium</code>
(<a href="http://appium.io/">Appium</a>) and <a href="http://appium.io/getting-started.html?lang=en">set it up</a>.
<strong>Appium</strong> is a tool to automate your app and emulate user interactions like clicking buttons or typing in the app.
Ensure that the app is built at least once and that the emulator is running.</p>

<p>You can then use the following <strong>NodeJS</strong> snippet to run a simple test.
In the example,
a value is typed entered into a text box,
and a button is clicked.</p>
<div class="highlight"><pre><code class="language-" data-lang="">var browserPerf = require('browser-perf');
browserPerf(undefined, function(err, res) {
    if (err) {
        console.log('An error occured');
    } else {
        console.log('Result is ', res);
    }
}, {
    selenium: "http://localhost:4723/wd/hub",
    browsers: [{
        platformName: "iOS",
        platformVersion: "8.0",
        deviceName: "iPhone Simulator",
        app: "~/cordovaapp/platforms/ios/build/emulator/HelloCordova.app",
        bundleId: "io.cordova.hellocordova",
        autoWebview: true
    }],
    log: console.log.bind(console),
    actions: [
        function(browser) {
            return browser.elementById('count').then(function(el) {
                el.type(1000);
            }).then(function() {
                return browser.elementById('checkout');
            }).then(function(el) {
                return el.click();
            });
        }
    ]
});
</code></pre></div>
<p>Additional user interactions can be used instead of typing and clicking by following the guide on <a href="https://github.com/axemclion/browser-perf/wiki/Node-Module---API#actions">this page</a>.</p>

<p>The <a href="https://www.youtube.com/watch?v=TG_eTe_H-s4">video below</a> illustrates the steps.
Note that in the video,
the config file does not specify any action.
Hence, the default action scrolls the page and records the metrics.</p>

<p><a href="https://www.youtube.com/watch?v=TG_eTe_H-s4"><img src="http://img.youtube.com/vi/TG_eTe_H-s4/0.jpg" alt="Video of steps to run perf tests in Cordova"></a></p>

<h2>Testing Android Apps</h2>

<p>Testing <strong>Android</strong> apps is very similar to testing <strong>iOS</strong> Apps.
The only difference would be the use of <a href="https://sites.google.com/a/chromium.org/chromedriver/">ChromeDriver</a> instead of <strong>Appium</strong>.
Consequently, the configuration would look something like <a href="https://github.com/axemclion/browser-perf/blob/master/test/res/android-hybrid.config.json">this</a>.</p>

<p>Additional details about setting up the test environment can be found
<a href="https://github.com/axemclion/browser-perf/wiki/Setup-Instructions#testing-mobile-cordova-webviewhybrid-applications">here</a>,
with reference for <code>browser-perf</code> in the
<a href="https://github.com/axemclion/browser-perf/wiki/Node-Module---API">axemclion wiki pages</a>.</p>

<h2>Finishing touches</h2>

<p><code>browser-perf</code> can record a plethora of metrics ranging from frame rates,
to count of expensive paints or expensive events that could cause jank.
Each of these metrics indicates how a CSS transform or an onscroll handler may have changed the performance of the app.
Recording this data over time can give better insight into how each code change affects the smooth experience.
The <code>res</code> object in browser-perf callback from the example snippet above can be saved to a database and graphed.
For example,
<a href="http://npmjs.org/package/perfjankie">Perfjankie</a> works on top of browser-perf,
stores the results in a <strong>CouchDB</strong> database, and displays the results.</p>

<h2>Summary</h2>

<p>In this article, we saw how to measure the rendering performance of <strong>Cordova</strong> apps.
With the tools described, you can ensure that your apps are just as good as native apps are supposed to be.</p>

<blockquote>
<p>If you would like to run this for your Cordova app, please <a href="http://twitter.com/nparashuram">contact me</a>, and I would be glad to help you to get started or check out this <a href="http://blog.nparashuram.com/2014/10/measuring-rendering-performance-metrics.html">related blog post</a>.</p>
</blockquote>

        </div>
    </section>
    <footer>
        <div class="row">
            <div class="col-sm-6">
                
                    <a href="/news/2014/11/13/tools-release.html">Previous</a>
                    <br>
                    <br>
                    <a class="title" href="/news/2014/11/13/tools-release.html">Tools Release: November 13, 2014</a>
                    <div class="date"> 13 Nov 2014 - By Mark Koudritsky </div>
                    <p class="content">
                        New versions of cordova tools are now live! cordova-lib@4.1.2 cordova@4.1.2 plugman@0.22.16 cordova-js@3.7.2...
                    </p>
                
            </div>
            <div class="col-sm-6">
                
                    <a href="/announcements/2014/11/25/ios-64bit.html">Next</a>
                    <br>
                    <br>
                    <a class="title" href="/announcements/2014/11/25/ios-64bit.html">iOS 64-bit apps in Cordova</a>
                    <div class="date"> 25 Nov 2014 - By Marcel Kinard </div>
                    <p class="content">
                        <!--
                            NOTE:
                                the markdownify filter is used here
                                because posts are rendered in sequence;
                                that is, the next post's content isn't
                                yet rendered at the time that this post
                                is being rendered, so page.next.excerpt
                                is still in Markdown and not HTML

                            Reference: https://github.com/jekyll/jekyll/issues/2860
                        -->
                        Apple has recently announced that new and updated apps submitted to the...
                    </p>
                
            </div>
        </div>
    </footer>
    <div class="disqus">
        <div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'cordovablogs';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

    </div>
</div>

</div>

</div>

<div class="blue-divider"></div>
<footer>
    <div class="container">
        <div class="row">
    <div class="col-sm-9">
        <h1>More Resources</h1>
        <div class="row">
            <div class="col-sm-4">
                <h2>General</h2>
                <ul class="nav">
                    <li>
                        <a target="_blank" href="https://projects.apache.org/project.html?cordova">Apache Project Page</a>
                    </li>
                    <li>
                        <a href="http://www.apache.org/dyn/closer.cgi/cordova">Source Distribution</a>
                    </li>
                    <li>
                        <a target="_blank" href="http://www.apache.org/licenses/LICENSE-2.0">License</a>
                    </li>
                    <li>
                        <a href="/artwork">Artwork</a>
                    </li>
                </ul>
            </div>
            <div class="col-sm-4">
                <h2>Development</h2>
                <ul class="nav">
                    <li><a target="_blank" href="https://github.com/apache?utf8=%E2%9C%93&amp;q=cordova-">Source Code</a></li>
                    <li><a target="_blank" href="https://issues.apache.org/jira/browse/CB/">Issue Tracker</a></li>
                    <li><a target="_blank" href="http://stackoverflow.com/questions/tagged/cordova">Stack Overflow</a></li>
                    <li><a href="/contact">Mailing List</a></li>
                    <li><a href="/contribute/nightly_builds.html">Nightly builds</a></li>
                </ul>
            </div>
            <div class="col-sm-4">
                <h2>Apache Software Foundation</h2>
                <ul class="nav">
                    <li>
                        <a target="_blank" href="http://www.apache.org/">About ASF</a>
                    </li>
                    <li>
                        <a target="_blank" href="http://www.apache.org/foundation/sponsorship.html">Become a Sponsor</a>
                    </li>
                    <li>
                        <a target="_blank" href="http://www.apache.org/foundation/thanks.html">Thanks</a>
                    </li>
                    <li>
                        <a target="_blank" href="http://www.apache.org/security/">Security</a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <div class="col-sm-3">
        <h1>Contribute</h1>
        <p style="padding-top:20px"><strong>Help Cordova move forward!</strong></p>
        <p>Report bugs, improve the docs, or contribute to the code.</p>
        <a href="/contribute" class="btn btn-lg btn-primary">
            Learn More
        </a>
        <p style="padding-top:20px"> <a href="https://twitter.com/apachecordova" class="twitter-follow-button" data-show-count="false">Follow @apachecordova</a></p>
    </div>
</div>
<p class="copyright_text">
    Copyright &copy; 2012, 2013, 2015 Apache软件基金会, 许可授权在 <a target="_blank" href="http://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a>.<br/>
    Apache and the Apache feather logos are <a target="_blank" href="http://www.apache.org/foundation/marks/list/">trademarks</a> of The Apache Software Foundation.
    <br/>
    "Raleway" font used under license. For details see the <a href="/attributions/">attributions page</a>.
</p>

    </div>
</footer>


    <script defer type="text/javascript" src="/static/js/index.js"></script>
    
    



    


<script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script>
<script type="text/javascript">
    docsearch({
        apiKey: '0a916ab198bd93d031aa70611271e42e',
        indexName: 'cordova',
        inputSelector: '#header-search-field',
        algoliaOptions: { 'facetFilters': ["version:  9.x", "language: zh-cn"] }
    });
</script>

</body>
</html>
